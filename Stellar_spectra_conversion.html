
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Stellar Spectra Conversion &#8212; (Exo)Planetary Atmosphere: the Impact of Stars and Solar Physics on Habitability and Life</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3rd Eddy Symposium (Exo)Planetary Atmosphere Working Group Day 1 Summary" href="day1sum.html" />
    <link rel="prev" title="Explore NASA Exoplanet Data" href="exoplanet-data-pull.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">(Exo)Planetary Atmosphere: the Impact of Stars and Solar Physics on Habitability and Life</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    (Exo)Planetary Atmosphere
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Processing
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="exoplanet-data-pull.html">
   Explore NASA Exoplanet Data
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Stellar Spectra Conversion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Workshop Activities
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="day1sum.html">
   3rd Eddy Symposium (Exo)Planetary Atmosphere Working Group Day 1 Summary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="day2sum.html">
   3rd Eddy Symposium (Exo)Planetary Atmosphere Working Group Day 2 Summary
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Stellar_spectra_conversion.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Stellar_spectra_conversion.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-guide">
   User Guide
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#to-do-list">
   To do list
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#list-of-muscles-database-below">
   List of MUSCLES database below
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-muscles-spectra">
   Import MUSCLES spectra
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Stellar Spectra Conversion</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-guide">
   User Guide
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#to-do-list">
   To do list
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#list-of-muscles-database-below">
   List of MUSCLES database below
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-muscles-spectra">
   Import MUSCLES spectra
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="stellar-spectra-conversion">
<h1>Stellar Spectra Conversion<a class="headerlink" href="#stellar-spectra-conversion" title="Permalink to this headline">#</a></h1>
<p>Created on June 6th 2022 &#64; 3rd Eddy Cross Disciplinary Symposium, Vail, CO, USA
Code based on original idea by Dan Marsh (NCAR, University of Leeds).</p>
<p><strong>Authors:</strong></p>
<ul class="simple">
<li><p>Gregory Cooke (University of Leeds, pygjc&#64;leeds.ac.uk)</p></li>
<li><p>Allison Youngblood (NASA Goddard)</p></li>
</ul>
<section id="user-guide">
<h2>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">#</a></h2>
<p>Code to read in files from the MUSCLES database
and scale them to be used in various atmospheric models
for different planets in those stellar systems</p>
<p>Run each cell until drop down menus appear
Select your desired options from dropdown menus</p>
</section>
<section id="to-do-list">
<h2>To do list<a class="headerlink" href="#to-do-list" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>rebin spectra</p></li>
<li><p>save out spectra file</p></li>
<li><p>add different climate model wavelength grids (only WACCM, ROCKE-3D so far)</p></li>
<li><p>comment code better</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interactive</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># return subscript number or text as a string</span>
<span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">Input</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">r</span><span class="s1">&#39;$_{&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span>

<span class="c1"># return superscript number or text as a string</span>
<span class="k">def</span> <span class="nf">sup</span><span class="p">(</span><span class="n">Input</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">r</span><span class="s1">&#39;$^{&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="list-of-muscles-database-below">
<h2>List of MUSCLES database below<a class="headerlink" href="#list-of-muscles-database-below" title="Permalink to this headline">#</a></h2>
<p>Program options begin here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Stellar_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;GJ 1132&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj1132/hlsp_muscles_multi_multi_gj1132_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 15A&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj15a/hlsp_muscles_multi_multi_gj15a_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 1214&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj1214/hlsp_muscles_multi_multi_gj1214_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 163&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj163/hlsp_muscles_multi_multi_gj163_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 176&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj176/hlsp_muscles_multi_multi_gj176_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 436&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj436/hlsp_muscles_multi_multi_gj436_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 581&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj581/hlsp_muscles_multi_multi_gj581_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 649&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj649/hlsp_muscles_multi_multi_gj649_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 667 C&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj667c/hlsp_muscles_multi_multi_gj667c_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 674&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj674/hlsp_muscles_multi_multi_gj674_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 676 A&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj676a/hlsp_muscles_multi_multi_gj676a_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 699&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj699/hlsp_muscles_multi_multi_gj699_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 729&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj729/hlsp_muscles_multi_multi_gj729_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 832&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj832/hlsp_muscles_multi_multi_gj832_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 849&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj849/hlsp_muscles_multi_multi_gj849_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ 876&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj876/hlsp_muscles_multi_multi_gj876_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;HD40307&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/hd40307/hlsp_muscles_multi_multi_hd40307_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;HD85512&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/hd85512/hlsp_muscles_multi_multi_hd85512_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;HD97658&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/hd97658/hlsp_muscles_multi_multi_hd97658_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;L-980-5&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/l-980-5/hlsp_muscles_multi_multi_l-980-5_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;LHS-2686&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/lhs-2686/hlsp_muscles_multi_multi_lhs-2686_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TRAPPIST-1&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/trappist-1/hlsp_muscles_multi_multi_trappist-1_broadband_v23_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;V-EPS-ERI&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/v-eps-eri/hlsp_muscles_multi_multi_v-eps-eri_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GJ551&#39;</span><span class="p">:</span><span class="s1">&#39;https://archive.stsci.edu/missions/hlsp/muscles/gj551/hlsp_muscles_multi_multi_gj551_broadband_v22_adapt-const-res-sed.fits&#39;</span><span class="p">}</span>

<span class="c1">#get a drop down menu</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="c1">#select directories for MUSCLES files</span>
<span class="n">MUSCLES_files</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">(</span><span class="n">Stellar_names</span><span class="p">),</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;MUSCLES Files:&#39;</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">MUSCLES_files</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d92461ba55db4bbb9bae41b02718ee86", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">set Spectra_name_same_as_host_name = False if looking at exoplanets around</span>
<span class="sd">a different star to the ones in the MUSCLES database</span>
<span class="sd">i.e you want spectra for an M8 star but the closest spectra availiable is TRAPPIST-1</span>
<span class="sd">otherwise in this example you will only be able to select TRAPPIST-1 planets </span>
<span class="sd">if Spectra_name_same_as_host_name = True</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">Spectra_name_same_as_host_name</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#get star name</span>
<span class="n">star_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">Stellar_names</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">MUSCLES_files</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-muscles-spectra">
<h2>Import MUSCLES spectra<a class="headerlink" href="#import-muscles-spectra" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">MUSCLES_files</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File already downloaded&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;wget &#39;</span><span class="o">+</span> <span class="n">MUSCLES_files</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2022-06-09 16:25:26--  https://archive.stsci.edu/missions/hlsp/muscles/gj1132/hlsp_muscles_multi_multi_gj1132_broadband_v23_adapt-const-res-sed.fits
Resolving archive.stsci.edu (archive.stsci.edu)... 130.167.201.60
Connecting to archive.stsci.edu (archive.stsci.edu)|130.167.201.60|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 13538880 (13M) [allicashion/octet-stream]
Saving to: ‘hlsp_muscles_multi_multi_gj1132_broadband_v23_adapt-const-res-sed.fits’

     0K .......... .......... .......... .......... ..........  0%  613K 22s
    50K .......... .......... .......... .......... ..........  0%  599K 22s
   100K .......... .......... .......... .......... ..........  1%  147M 14s
   150K .......... .......... .......... .......... ..........  1% 1.18M 13s
   200K .......... .......... .......... .......... ..........  1% 65.8M 11s
   250K .......... .......... .......... .......... ..........  2%  242M 9s
   300K .......... .......... .......... .......... ..........  2% 1.21M 9s
   350K .......... .......... .......... .......... ..........  3%  132M 8s
   400K .......... .......... .......... .......... ..........  3% 36.6M 7s
   450K .......... .......... .......... .......... ..........  3%  246M 6s
   500K .......... .......... .......... .......... ..........  4% 91.7M 6s
   550K .......... .......... .......... .......... ..........  4%  202M 5s
   600K .......... .......... .......... .......... ..........  4%  118M 5s
   650K .......... .......... .......... .......... ..........  5% 1.24M 5s
   700K .......... .......... .......... .......... ..........  5%  249M 5s
   750K .......... .......... .......... .......... ..........  6%  139M 5s
   800K .......... .......... .......... .......... ..........  6%  119M 4s
   850K .......... .......... .......... .......... ..........  6%  133M 4s
   900K .......... .......... .......... .......... ..........  7%  149M 4s
   950K .......... .......... .......... .......... ..........  7%  145M 4s
  1000K .......... .......... .......... .......... ..........  7%  139M 3s
  1050K .......... .......... .......... .......... ..........  8% 99.8M 3s
  1100K .......... .......... .......... .......... ..........  8%  139M 3s
  1150K .......... .......... .......... .......... ..........  9%  165M 3s
  1200K .......... .......... .......... .......... ..........  9%  138M 3s
  1250K .......... .......... .......... .......... ..........  9%  150M 3s
  1300K .......... .......... .......... .......... .......... 10% 1.30M 3s
  1350K .......... .......... .......... .......... .......... 10%  214M 3s
  1400K .......... .......... .......... .......... .......... 10%  179M 3s
  1450K .......... .......... .......... .......... .......... 11%  141M 3s
  1500K .......... .......... .......... .......... .......... 11%  180M 3s
  1550K .......... .......... .......... .......... .......... 12%  149M 2s
  1600K .......... .......... .......... .......... .......... 12%  145M 2s
  1650K .......... .......... .......... .......... .......... 12%  126M 2s
  1700K .......... .......... .......... .......... .......... 13%  249M 2s
  1750K .......... .......... .......... .......... .......... 13%  146M 2s
  1800K .......... .......... .......... .......... .......... 13%  153M 2s
  1850K .......... .......... .......... .......... .......... 14%  153M 2s
  1900K .......... .......... .......... .......... .......... 14%  156M 2s
  1950K .......... .......... .......... .......... .......... 15%  181M 2s
  2000K .......... .......... .......... .......... .......... 15%  144M 2s
  2050K .......... .......... .......... .......... .......... 15%  129M 2s
  2100K .......... .......... .......... .......... .......... 16%  148M 2s
  2150K .......... .......... .......... .......... .......... 16%  143M 2s
  2200K .......... .......... .......... .......... .......... 17%  122M 2s
  2250K .......... .......... .......... .......... .......... 17%  150M 2s
  2300K .......... .......... .......... .......... .......... 17%  145M 2s
  2350K .......... .......... .......... .......... .......... 18%  158M 2s
  2400K .......... .......... .......... .......... .......... 18%  134M 1s
  2450K .......... .......... .......... .......... .......... 18%  146M 1s
  2500K .......... .......... .......... .......... .......... 19%  163M 1s
  2550K .......... .......... .......... .......... .......... 19%  155M 1s
  2600K .......... .......... .......... .......... .......... 20% 1.46M 1s
  2650K .......... .......... .......... .......... .......... 20% 42.1M 1s
  2700K .......... .......... .......... .......... .......... 20%  175M 1s
  2750K .......... .......... .......... .......... .......... 21% 68.8M 1s
  2800K .......... .......... .......... .......... .......... 21%  109M 1s
  2850K .......... .......... .......... .......... .......... 21%  161M 1s
  2900K .......... .......... .......... .......... .......... 22%  134M 1s
  2950K .......... .......... .......... .......... .......... 22%  162M 1s
  3000K .......... .......... .......... .......... .......... 23%  120M 1s
  3050K .......... .......... .......... .......... .......... 23%  159M 1s
  3100K .......... .......... .......... .......... .......... 23%  138M 1s
  3150K .......... .......... .......... .......... .......... 24%  145M 1s
  3200K .......... .......... .......... .......... .......... 24%  147M 1s
  3250K .......... .......... .......... .......... .......... 24% 58.7M 1s
  3300K .......... .......... .......... .......... .......... 25%  208M 1s
  3350K .......... .......... .......... .......... .......... 25%  125M 1s
  3400K .......... .......... .......... .......... .......... 26% 68.0M 1s
  3450K .......... .......... .......... .......... .......... 26%  131M 1s
  3500K .......... .......... .......... .......... .......... 26%  141M 1s
  3550K .......... .......... .......... .......... .......... 27%  171M 1s
  3600K .......... .......... .......... .......... .......... 27% 71.3M 1s
  3650K .......... .......... .......... .......... .......... 27% 95.9M 1s
  3700K .......... .......... .......... .......... .......... 28%  115M 1s
  3750K .......... .......... .......... .......... .......... 28% 41.1M 1s
  3800K .......... .......... .......... .......... .......... 29%  122M 1s
  3850K .......... .......... .......... .......... .......... 29%  150M 1s
  3900K .......... .......... .......... .......... .......... 29%  135M 1s
  3950K .......... .......... .......... .......... .......... 30%  148M 1s
  4000K .......... .......... .......... .......... .......... 30%  108M 1s
  4050K .......... .......... .......... .......... .......... 31%  157M 1s
  4100K .......... .......... .......... .......... .......... 31%  122M 1s
  4150K .......... .......... .......... .......... .......... 31%  154M 1s
  4200K .......... .......... .......... .......... .......... 32%  121M 1s
  4250K .......... .......... .......... .......... .......... 32%  157M 1s
  4300K .......... .......... .......... .......... .......... 32%  137M 1s
  4350K .......... .......... .......... .......... .......... 33%  128M 1s
  4400K .......... .......... .......... .......... .......... 33%  157M 1s
  4450K .......... .......... .......... .......... .......... 34%  140M 1s
  4500K .......... .......... .......... .......... .......... 34%  182M 1s
  4550K .......... .......... .......... .......... .......... 34%  137M 1s
  4600K .......... .......... .......... .......... .......... 35%  133M 1s
  4650K .......... .......... .......... .......... .......... 35%  138M 1s
  4700K .......... .......... .......... .......... .......... 35%  136M 1s
  4750K .......... .......... .......... .......... .......... 36%  201M 1s
  4800K .......... .......... .......... .......... .......... 36%  127M 1s
  4850K .......... .......... .......... .......... .......... 37%  140M 1s
  4900K .......... .......... .......... .......... .......... 37%  160M 1s
  4950K .......... .......... .......... .......... .......... 37%  144M 1s
  5000K .......... .......... .......... .......... .......... 38%  126M 1s
  5050K .......... .......... .......... .......... .......... 38%  153M 1s
  5100K .......... .......... .......... .......... .......... 38%  158M 1s
  5150K .......... .......... .......... .......... .......... 39%  151M 1s
  5200K .......... .......... .......... .......... .......... 39% 2.29M 1s
  5250K .......... .......... .......... .......... .......... 40%  132M 1s
  5300K .......... .......... .......... .......... .......... 40% 26.0M 1s
  5350K .......... .......... .......... .......... .......... 40%  179M 1s
  5400K .......... .......... .......... .......... .......... 41%  127M 1s
  5450K .......... .......... .......... .......... .......... 41%  108M 1s
  5500K .......... .......... .......... .......... .......... 41%  172M 1s
  5550K .......... .......... .......... .......... .......... 42% 80.6M 1s
  5600K .......... .......... .......... .......... .......... 42%  163M 1s
  5650K .......... .......... .......... .......... .......... 43%  127M 1s
  5700K .......... .......... .......... .......... .......... 43%  125M 1s
  5750K .......... .......... .......... .......... .......... 43%  183M 1s
  5800K .......... .......... .......... .......... .......... 44%  102M 1s
  5850K .......... .......... .......... .......... .......... 44%  139M 1s
  5900K .......... .......... .......... .......... .......... 45%  154M 1s
  5950K .......... .......... .......... .......... .......... 45%  159M 1s
  6000K .......... .......... .......... .......... .......... 45%  137M 1s
  6050K .......... .......... .......... .......... .......... 46%  149M 0s
  6100K .......... .......... .......... .......... .......... 46% 83.6M 0s
  6150K .......... .......... .......... .......... .......... 46%  105M 0s
  6200K .......... .......... .......... .......... .......... 47%  101M 0s
  6250K .......... .......... .......... .......... .......... 47%  105M 0s
  6300K .......... .......... .......... .......... .......... 48%  107M 0s
  6350K .......... .......... .......... .......... .......... 48%  106M 0s
  6400K .......... .......... .......... .......... .......... 48%  140M 0s
  6450K .......... .......... .......... .......... .......... 49%  156M 0s
  6500K .......... .......... .......... .......... .......... 49%  123M 0s
  6550K .......... .......... .......... .......... .......... 49%  160M 0s
  6600K .......... .......... .......... .......... .......... 50%  143M 0s
  6650K .......... .......... .......... .......... .......... 50%  127M 0s
  6700K .......... .......... .......... .......... .......... 51%  173M 0s
  6750K .......... .......... .......... .......... .......... 51%  122M 0s
  6800K .......... .......... .......... .......... .......... 51%  156M 0s
  6850K .......... .......... .......... .......... .......... 52%  149M 0s
  6900K .......... .......... .......... .......... .......... 52%  153M 0s
  6950K .......... .......... .......... .......... .......... 52%  130M 0s
  7000K .......... .......... .......... .......... .......... 53%  143M 0s
  7050K .......... .......... .......... .......... .......... 53%  142M 0s
  7100K .......... .......... .......... .......... .......... 54%  129M 0s
  7150K .......... .......... .......... .......... .......... 54%  154M 0s
  7200K .......... .......... .......... .......... .......... 54%  115M 0s
  7250K .......... .......... .......... .......... .......... 55%  133M 0s
  7300K .......... .......... .......... .......... .......... 55%  147M 0s
  7350K .......... .......... .......... .......... .......... 55%  140M 0s
  7400K .......... .......... .......... .......... .......... 56%  130M 0s
  7450K .......... .......... .......... .......... .......... 56%  161M 0s
  7500K .......... .......... .......... .......... .......... 57% 85.8M 0s
  7550K .......... .......... .......... .......... .......... 57%  187M 0s
  7600K .......... .......... .......... .......... .......... 57%  127M 0s
  7650K .......... .......... .......... .......... .......... 58%  131M 0s
  7700K .......... .......... .......... .......... .......... 58%  134M 0s
  7750K .......... .......... .......... .......... .......... 58%  176M 0s
  7800K .......... .......... .......... .......... .......... 59% 80.7M 0s
  7850K .......... .......... .......... .......... .......... 59%  147M 0s
  7900K .......... .......... .......... .......... .......... 60%  107M 0s
  7950K .......... .......... .......... .......... .......... 60%  160M 0s
  8000K .......... .......... .......... .......... .......... 60%  137M 0s
  8050K .......... .......... .......... .......... .......... 61%  131M 0s
  8100K .......... .......... .......... .......... .......... 61% 2.66M 0s
  8150K .......... .......... .......... .......... .......... 62%  177M 0s
  8200K .......... .......... .......... .......... .......... 62%  140M 0s
  8250K .......... .......... .......... .......... .......... 62%  118M 0s
  8300K .......... .......... .......... .......... .......... 63% 33.4M 0s
  8350K .......... .......... .......... .......... .......... 63%  219M 0s
  8400K .......... .......... .......... .......... .......... 63% 53.4M 0s
  8450K .......... .......... .......... .......... .......... 64%  110M 0s
  8500K .......... .......... .......... .......... .......... 64% 19.8M 0s
  8550K .......... .......... .......... .......... .......... 65%  193M 0s
  8600K .......... .......... .......... .......... .......... 65% 63.0M 0s
  8650K .......... .......... .......... .......... .......... 65% 79.2M 0s
  8700K .......... .......... .......... .......... .......... 66%  172M 0s
  8750K .......... .......... .......... .......... .......... 66%  141M 0s
  8800K .......... .......... .......... .......... .......... 66%  115M 0s
  8850K .......... .......... .......... .......... .......... 67%  162M 0s
  8900K .......... .......... .......... .......... .......... 67%  141M 0s
  8950K .......... .......... .......... .......... .......... 68%  175M 0s
  9000K .......... .......... .......... .......... .......... 68% 96.9M 0s
  9050K .......... .......... .......... .......... .......... 68%  163M 0s
  9100K .......... .......... .......... .......... .......... 69%  116M 0s
  9150K .......... .......... .......... .......... .......... 69%  180M 0s
  9200K .......... .......... .......... .......... .......... 69%  115M 0s
  9250K .......... .......... .......... .......... .......... 70%  123M 0s
  9300K .......... .......... .......... .......... .......... 70%  159M 0s
  9350K .......... .......... .......... .......... .......... 71%  143M 0s
  9400K .......... .......... .......... .......... .......... 71%  135M 0s
  9450K .......... .......... .......... .......... .......... 71%  156M 0s
  9500K .......... .......... .......... .......... .......... 72%  136M 0s
  9550K .......... .......... .......... .......... .......... 72%  169M 0s
  9600K .......... .......... .......... .......... .......... 72% 90.4M 0s
  9650K .......... .......... .......... .......... .......... 73%  131M 0s
  9700K .......... .......... .......... .......... .......... 73%  145M 0s
  9750K .......... .......... .......... .......... .......... 74%  128M 0s
  9800K .......... .......... .......... .......... .......... 74%  152M 0s
  9850K .......... .......... .......... .......... .......... 74%  161M 0s
  9900K .......... .......... .......... .......... .......... 75%  129M 0s
  9950K .......... .......... .......... .......... .......... 75%  158M 0s
 10000K .......... .......... .......... .......... .......... 76% 36.3M 0s
 10050K .......... .......... .......... .......... .......... 76%  123M 0s
 10100K .......... .......... .......... .......... .......... 76%  135M 0s
 10150K .......... .......... .......... .......... .......... 77%  191M 0s
 10200K .......... .......... .......... .......... .......... 77%  103M 0s
 10250K .......... .......... .......... .......... .......... 77%  164M 0s
 10300K .......... .......... .......... .......... .......... 78%  152M 0s
 10350K .......... .......... .......... .......... .......... 78%  148M 0s
 10400K .......... .......... .......... .......... .......... 79%  133M 0s
 10450K .......... .......... .......... .......... .......... 79%  116M 0s
 10500K .......... .......... .......... .......... .......... 79%  172M 0s
 10550K .......... .......... .......... .......... .......... 80% 65.7M 0s
 10600K .......... .......... .......... .......... .......... 80%  125M 0s
 10650K .......... .......... .......... .......... .......... 80% 87.5M 0s
 10700K .......... .......... .......... .......... .......... 81%  176M 0s
 10750K .......... .......... .......... .......... .......... 81%  128M 0s
 10800K .......... .......... .......... .......... .......... 82%  141M 0s
 10850K .......... .......... .......... .......... .......... 82%  147M 0s
 10900K .......... .......... .......... .......... .......... 82%  164M 0s
 10950K .......... .......... .......... .......... .......... 83% 2.77M 0s
 11000K .......... .......... .......... .......... .......... 83%  111M 0s
 11050K .......... .......... .......... .......... .......... 83%  100M 0s
 11100K .......... .......... .......... .......... .......... 84%  141M 0s
 11150K .......... .......... .......... .......... .......... 84%  163M 0s
 11200K .......... .......... .......... .......... .......... 85%  120M 0s
 11250K .......... .......... .......... .......... .......... 85%  148M 0s
 11300K .......... .......... .......... .......... .......... 85%  134M 0s
 11350K .......... .......... .......... .......... .......... 86%  171M 0s
 11400K .......... .......... .......... .......... .......... 86%  122M 0s
 11450K .......... .......... .......... .......... .......... 86%  139M 0s
 11500K .......... .......... .......... .......... .......... 87%  169M 0s
 11550K .......... .......... .......... .......... .......... 87% 47.7M 0s
 11600K .......... .......... .......... .......... .......... 88% 49.8M 0s
 11650K .......... .......... .......... .......... .......... 88% 85.1M 0s
 11700K .......... .......... .......... .......... .......... 88%  128M 0s
 11750K .......... .......... .......... .......... .......... 89%  109M 0s
 11800K .......... .......... .......... .......... .......... 89%  159M 0s
 11850K .......... .......... .......... .......... .......... 90% 36.9M 0s
 11900K .......... .......... .......... .......... .......... 90%  176M 0s
 11950K .......... .......... .......... .......... .......... 90%  136M 0s
 12000K .......... .......... .......... .......... .......... 91%  159M 0s
 12050K .......... .......... .......... .......... .......... 91% 61.3M 0s
 12100K .......... .......... .......... .......... .......... 91%  210M 0s
 12150K .......... .......... .......... .......... .......... 92%  124M 0s
 12200K .......... .......... .......... .......... .......... 92%  229M 0s
 12250K .......... .......... .......... .......... .......... 93% 39.1M 0s
 12300K .......... .......... .......... .......... .......... 93%  150M 0s
 12350K .......... .......... .......... .......... .......... 93%  162M 0s
 12400K .......... .......... .......... .......... .......... 94%  127M 0s
 12450K .......... .......... .......... .......... .......... 94%  134M 0s
 12500K .......... .......... .......... .......... .......... 94%  198M 0s
 12550K .......... .......... .......... .......... .......... 95%  132M 0s
 12600K .......... .......... .......... .......... .......... 95% 49.7M 0s
 12650K .......... .......... .......... .......... .......... 96%  244M 0s
 12700K .......... .......... .......... .......... .......... 96%  104M 0s
 12750K .......... .......... .......... .......... .......... 96%  145M 0s
 12800K .......... .......... .......... .......... .......... 97%  125M 0s
 12850K .......... .......... .......... .......... .......... 97%  155M 0s
 12900K .......... .......... .......... .......... .......... 97%  129M 0s
 12950K .......... .......... .......... .......... .......... 98%  141M 0s
 13000K .......... .......... .......... .......... .......... 98%  141M 0s
 13050K .......... .......... .......... .......... .......... 99%  124M 0s
 13100K .......... .......... .......... .......... .......... 99%  160M 0s
 13150K .......... .......... .......... .......... .......... 99%  159M 0s
 13200K .......... .......... .                               100%  143M=0.5s

2022-06-09 16:25:27 (24.8 MB/s) - ‘hlsp_muscles_multi_multi_gj1132_broadband_v23_adapt-const-res-sed.fits’ saved [13538880/13538880]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spec</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">MUSCLES_files</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s1">&#39;WAVELENGTH&#39;</span><span class="p">],</span><span class="n">spec</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;MUSCLES spectra of &#39;</span><span class="o">+</span><span class="n">star_name</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux Density (erg/cm2/s/Ang)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Stellar_spectra_conversion_9_0.png" src="_images/Stellar_spectra_conversion_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#convert to mW/m2/nm</span>
<span class="n">per_cm2_to_per_m2</span> <span class="o">=</span> <span class="mi">100</span><span class="o">**</span><span class="mi">2</span>
<span class="n">erg_per_s_to_mW</span> <span class="o">=</span> <span class="mf">1e-4</span>
<span class="n">per_Ang_to_per_nm</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">New_flux</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">erg_per_s_to_mW</span> <span class="o">*</span> <span class="n">per_cm2_to_per_m2</span> <span class="o">*</span> <span class="n">per_Ang_to_per_nm</span>
<span class="n">Wavelength_nm</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="s1">&#39;WAVELENGTH&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot in new units</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">plt.figure(figsize = (12,5))</span>
<span class="sd">plt.plot(Wavelength_nm,New_flux, color = &#39;k&#39;, label = &#39;MUSCLES spectra of &#39;+star_name)</span>
<span class="sd">plt.tick_params(labelsize = 15, width = 2, length = 4, right = True, top = True)</span>
<span class="sd">plt.xlabel(&#39;Wavelength&#39;, fontsize = 15); plt.xscale(&#39;log&#39;)</span>
<span class="sd">plt.ylabel(&#39;Flux Density mW/m&#39;+sup(2)+&#39;/nm)&#39;, fontsize = 15); plt.yscale(&#39;log&#39;)</span>
<span class="sd">plt.legend(loc = 0, frameon = False, fontsize = 15)</span>
<span class="sd">&#39;&#39;&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#remove MUSCLES files in current directory</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;rm *muscles*.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#find total stellar irradiance from file</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">trapz</span>
<span class="c1">#get total stellar irradiance at top of atmosphere</span>
<span class="n">TSI_spectra</span> <span class="o">=</span> <span class="n">trapz</span><span class="p">(</span><span class="n">New_flux</span><span class="p">,</span><span class="n">Wavelength_nm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total stellar irradiance relative to the Sun: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TSI_spectra</span><span class="o">/</span><span class="mi">1360000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total stellar irradiance relative to the Sun: 8.605194006526416e-17
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># scale TSI</span>
<span class="n">Scaled_flux_to_Earth</span> <span class="o">=</span> <span class="n">New_flux</span><span class="o">/</span><span class="p">(</span><span class="n">TSI_spectra</span><span class="o">/</span><span class="mi">1360000</span><span class="p">)</span>
<span class="n">TSI_spectra</span> <span class="o">=</span> <span class="n">trapz</span><span class="p">(</span><span class="n">Scaled_flux_to_Earth</span><span class="p">,</span> <span class="n">Wavelength_nm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scaled total stellar irradiance relative to the Sun: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TSI_spectra</span><span class="o">/</span><span class="mi">1360000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scaled total stellar irradiance relative to the Sun: 1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Select climate model</span>
<span class="n">Climate_model_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;WACCM&#39;</span><span class="p">,</span><span class="s1">&#39;CAM&#39;</span><span class="p">,</span><span class="s1">&#39;ExoCam&#39;</span><span class="p">,</span><span class="s1">&#39;UM&#39;</span><span class="p">,</span><span class="s1">&#39;ROCKE-3D&#39;</span><span class="p">,</span><span class="s1">&#39;CCSM3&#39;</span><span class="p">,</span><span class="s1">&#39;Atmos&#39;</span><span class="p">,</span><span class="s1">&#39;ExoPrime&#39;</span><span class="p">]</span>
<span class="n">Climate_model_selection</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">Climate_model_list</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Select climate model&#39;</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Climate_model_selection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3f0299c6e3a1423a94e82f050fcaf3ea", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Compare to WACCM standard solar file</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Climate_model_selection</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;WACCM&#39;</span> <span class="ow">or</span> <span class="n">Climate_model_selection</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;CAM&#39;</span><span class="p">):</span>
    <span class="c1">#check for file. Download if not in directory</span>
    <span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;SolarForcingCMIP6piControl_c160921.nc&#39;</span><span class="p">)):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File already downloaded&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;wget https://svn-ccsm-inputdata.cgd.ucar.edu/trunk/inputdata/atm/cam/solar/SolarForcingCMIP6piControl_c160921.nc --no-check-certificate&#39;</span><span class="p">)</span>
    <span class="n">solar_file</span> <span class="o">=</span> <span class="s1">&#39;SolarForcingCMIP6piControl_c160921.nc&#39;</span><span class="c1">#read in file</span>

    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">solar_file</span><span class="p">)</span><span class="c1">#attach file to dataset</span>
    <span class="n">ssi</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;ssi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#define dataset from file</span>
    <span class="n">model_flux</span> <span class="o">=</span> <span class="n">ssi</span><span class="o">.</span><span class="n">values</span> <span class="c1">#flux values</span>
    <span class="n">model_wavelength</span> <span class="o">=</span> <span class="n">ssi</span><span class="o">.</span><span class="n">wavelength</span><span class="o">.</span><span class="n">values</span> <span class="c1">#wavelength grid</span>
    <span class="n">starlabel</span> <span class="o">=</span> <span class="s1">&#39;Sun&#39;</span> <span class="c1">#label for plot</span>
    
<span class="k">elif</span><span class="p">(</span><span class="n">Climate_model_selection</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;ExoCAM&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ExoCam spectrum input file unknown&#39;</span><span class="p">)</span>  
    
<span class="k">elif</span><span class="p">(</span><span class="n">Climate_model_selection</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;UM&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;UM spectrum input file unknown&#39;</span><span class="p">)</span>  
    
<span class="k">elif</span><span class="p">(</span><span class="n">Climate_model_selection</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;ROCKE-3D&#39;</span><span class="p">):</span>
    <span class="c1">#check for file. Download if not in directory</span>
    <span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;sun&#39;</span><span class="p">)):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File already downloaded&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;wget https://portal.nccs.nasa.gov/GISS_modelE/ROCKE-3D/stellar_spectra/sun&#39;</span><span class="p">)</span>
    <span class="n">solar_file</span> <span class="o">=</span> <span class="s1">&#39;SolarForcingCMIP6piControl_c160921.nc&#39;</span><span class="c1">#read in file</span>
    <span class="n">ROCKE_3D_solar_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;sun&#39;</span><span class="p">,</span> <span class="n">skip_header</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">skip_footer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">model_flux</span> <span class="o">=</span> <span class="n">ROCKE_3D_solar_input</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">model_wavelength</span> <span class="o">=</span>  <span class="n">ROCKE_3D_solar_input</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e9</span> <span class="c1">#wavelength grid</span>
    <span class="n">starlabel</span> <span class="o">=</span> <span class="s1">&#39;Sun&#39;</span> <span class="c1">#label for plot</span>
    
<span class="k">elif</span><span class="p">(</span><span class="n">Climate_model_selection</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;CCSM3&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CCSM3 spectrum input file unknown&#39;</span><span class="p">)</span> 
    
<span class="k">elif</span><span class="p">(</span><span class="n">Climate_model_selection</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Atmos&#39;</span><span class="p">):</span>
    <span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;muscles_gj667c.txt&#39;</span><span class="p">)):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File already downloaded&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;wget https://raw.githubusercontent.com/VirtualPlanetaryLaboratory/atmos/master/PHOTOCHEM/DATA/FLUX/muscles_gj667c.txt&#39;</span><span class="p">)</span>
    <span class="n">ATMOS_gj667c_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;muscles_gj667c.txt&#39;</span><span class="p">)</span>
    <span class="n">model_wavelength</span> <span class="o">=</span> <span class="n">ATMOS_gj667c_input</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span>
    <span class="n">model_flux</span> <span class="o">=</span> <span class="n">ATMOS_gj667c_input</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">starlabel</span> <span class="o">=</span> <span class="s1">&#39;GJ 667 C&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spectrum input file unknown&#39;</span><span class="p">)</span>
    
<span class="c1">#compare spectra to Sun</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Wavelength_nm</span><span class="p">,</span> <span class="n">Scaled_flux_to_Earth</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;MUSCLES spectra of &#39;</span><span class="o">+</span><span class="n">star_name</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_wavelength</span><span class="p">,</span> <span class="n">model_flux</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">starlabel</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength [nm]&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance [W/m]&#39;</span><span class="o">+</span><span class="n">sup</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File already downloaded
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f0deb425700&gt;
</pre></div>
</div>
<img alt="_images/Stellar_spectra_conversion_16_2.png" src="_images/Stellar_spectra_conversion_16_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">NASA_Exo_Archive</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://exoplanetarchive.ipac.caltech.edu/TAP/sync?query=select+*+from+ps&amp;format=csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_79/512134744.py:2: DtypeWarning: Columns (50,65,148,153,183,187,206,211,237,242) have mixed types. Specify dtype option on import or set low_memory=False.
  NASA_Exo_Archive = pd.read_csv(&#39;https://exoplanetarchive.ipac.caltech.edu/TAP/sync?query=select+*+from+ps&amp;format=csv&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Find planets based on host name</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Spectra_name_same_as_host_name</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
    <span class="c1">#choose planet</span>
    <span class="n">planets</span> <span class="o">=</span> <span class="n">NASA_Exo_Archive</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">NASA_Exo_Archive</span><span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">star_name</span><span class="p">][</span><span class="s1">&#39;pl_name&#39;</span><span class="p">]</span>
    <span class="n">Find_planets</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">planets</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(),</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Find planets&#39;</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Find_planets</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">Find_host</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">(</span><span class="n">NASA_Exo_Archive</span><span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()),</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Find host&#39;</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Find_host</span><span class="p">)</span>
    
    <span class="c1">#choose planet</span>
    <span class="n">planets</span> <span class="o">=</span> <span class="n">NASA_Exo_Archive</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">NASA_Exo_Archive</span><span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Find_host</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s1">&#39;pl_name&#39;</span><span class="p">]</span>
    <span class="n">Find_planets</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">planets</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Find planets&#39;</span><span class="p">,</span><span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Find_planets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "29749ba8ad644d5fb99a8e73c3de463c", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#drop nan rows ofr luminosity and orbital period</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">NASA_Exo_Archive</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">NASA_Exo_Archive</span><span class="p">[</span><span class="s1">&#39;pl_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Find_planets</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;st_lum&#39;</span><span class="p">)</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;pl_orbsmax&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#find semi-major axis in AU</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rowupdate&#39;</span><span class="p">])</span>
<span class="n">semi_major_axis</span> <span class="o">=</span> <span class="n">pl</span><span class="p">[</span><span class="s1">&#39;pl_orbsmax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;semi-major axis of &#39;</span><span class="o">+</span><span class="n">Find_planets</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="s1">&#39; = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">semi_major_axis</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; AU&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>semi-major axis of TRAPPIST-1 h = 0.06189 AU
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#find solar luminosity relative to Sun</span>
<span class="n">stellar_luminosity</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">pl</span><span class="p">[</span><span class="s1">&#39;st_lum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Star has &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">stellar_luminosity</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; times luminosity of Sun&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Star has 0.0005533501092157366 times luminosity of Sun
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flux_recieved_relative_to_Earth</span> <span class="o">=</span> <span class="n">stellar_luminosity</span><span class="o">/</span><span class="p">(</span><span class="n">semi_major_axis</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Find_planets</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="s1">&#39; recieves &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flux_recieved_relative_to_Earth</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; times flux recieved by Earth&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TRAPPIST-1 h recieves 0.14446380006154927 times flux recieved by Earth
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#add in infrared wavelengths if required</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#rebin to wavelength grid</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rescale to planet</span>
<span class="n">Final_scaled_flux</span> <span class="o">=</span> <span class="n">Scaled_flux_to_Earth</span> <span class="o">*</span> <span class="n">flux_recieved_relative_to_Earth</span>
<span class="n">TSI_spectra</span> <span class="o">=</span> <span class="n">trapz</span><span class="p">(</span><span class="n">Final_scaled_flux</span><span class="p">,</span> <span class="n">Wavelength_nm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Scaled total stellar irradiance relative to the Sun: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TSI_spectra</span><span class="o">/</span><span class="mi">1360000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scaled total stellar irradiance relative to the Sun: 0.14446380006154927
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#final spectra compared to Sun</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Wavelength_nm</span><span class="p">,</span> <span class="n">Final_scaled_flux</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Scaled MUSCLES spectra of</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">star_name</span><span class="o">+</span> <span class="s1">&#39; at &#39;</span> <span class="o">+</span> <span class="n">Find_planets</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">TSI_spectra</span><span class="o">/</span><span class="mi">1360000</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$F_\oplus$&#39;</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_wavelength</span><span class="p">,</span><span class="n">model_flux</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Sun&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength [nm]&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux Density mW/m&#39;</span><span class="o">+</span><span class="n">sup</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/nm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f0deb479580&gt;
</pre></div>
</div>
<img alt="_images/Stellar_spectra_conversion_27_1.png" src="_images/Stellar_spectra_conversion_27_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#extra information about planet</span>
<span class="c1">#orbital period</span>
<span class="n">period</span> <span class="o">=</span> <span class="n">pl</span><span class="p">[</span><span class="s1">&#39;pl_orbper&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#orbital radius</span>
<span class="n">radius</span> <span class="o">=</span> <span class="n">pl</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="exoplanet-data-pull.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Explore NASA Exoplanet Data</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="day1sum.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3rd Eddy Symposium (Exo)Planetary Atmosphere Working Group Day 1 Summary</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By ???<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>